diff --git a/configure b/configure
index 47cc203..530738a 100755
--- a/configure
+++ b/configure
@@ -259,7 +259,14 @@ case "$bytecc,$host" in
     bytecccompopts="-fno-defer-pop $gcc_warnings -DSHRINKED_GNUC"
     mathlib="";;
   *,*-*-darwin*)
-    bytecccompopts="-fno-defer-pop -no-cpp-precomp $gcc_warnings"
+    # On recent version of OSX, gcc is a symlink to clang
+    if $bytecc --version | grep -q clang; then
+        # -fno-defer-pop is not supported by clang, and make recent
+        # versions of clang to fail
+        bytecccompopts="-no-cpp-precomp $gcc_warnings"
+    else
+        bytecccompopts="-fno-defer-pop -no-cpp-precomp $gcc_warnings"
+    fi
     mathlib=""
     # Tell gcc that we can use 32-bit code addresses for threaded code
     # unless we are compiled for a shared library (-fPIC option)
@@ -576,7 +583,7 @@ if test $withsharedlibs = "yes"; then
       byteccrpath="-Wl,-rpath,"
       mksharedlibrpath="-rpath "
       shared_libraries_supported=true;;
-    i[3456]86-*-darwin10.*)
+    i[3456]86-*-darwin1[0123456789].*)
        mksharedlib="$bytecc -bundle -flat_namespace -undefined suppress"
        bytecccompopts="$dl_defs $bytecccompopts"
        dl_needs_underscore=false
@@ -620,7 +627,7 @@ if test $withsharedlibs = "yes"; then
     *-*-cygwin*)                  natdynlink=true;;
     i[3456]86-*-linux*)           natdynlink=true;;
     x86_64-*-linux*)              natdynlink=true;;
-    i[3456]86-*-darwin10.*)
+    i[3456]86-*-darwin1[0123456789].*)
       if test $arch64 == true; then
         natdynlink=true
       fi;;
